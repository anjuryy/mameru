import{r as n,j as e}from"./react-BQWWVmFX.js";import{A as y}from"./AuthenticatedLayout-DAW9oBGY.js";import{d as N,a as S}from"./@inertiajs-DgTH4HPv.js";import{I as M}from"./react-infinite-scroll-component-Dt96xtYz.js";import{a as j}from"./axios-Di5RpEPX.js";import{S as b,D as w,L as f,A as u,I as E,E as I}from"./antd-DLl5MYYz.js";import{T as P}from"./TextInput-Bx7mnX4H.js";import{P as H}from"./pusher-js-zpr4miFz.js";import{M as A,I as D}from"./@ant-design-YQKfHlvO.js";import"./@react-three-Lu4PhzKs.js";import"./@babel-CiGj-Vf4.js";import"./three-DPTIurfh.js";import"./react-use-measure-CItih8FL.js";import"./debounce-SbLX0B7I.js";import"./its-fine-Cj9KCxhE.js";import"./react-reconciler-CTGvMkf5.js";import"./react-dom-BYk3QVVJ.js";import"./scheduler-CzFDRTuY.js";import"./maath-D_42bLYV.js";import"./three-stdlib-CNW_F6FS.js";import"./zustand-ZOt2ZkLF.js";import"./suspend-react-BKIKQNXN.js";import"./ApplicationLogo-D7Ae66s5.js";import"./Dropdown-9Ty2lfCN.js";import"./@headlessui-CStl0mCv.js";import"./deepmerge-DWXj7tTm.js";import"./qs-Buzh4mrw.js";import"./side-channel-Dxn6EU3U.js";import"./get-intrinsic-B1Ut8WxJ.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-B8G-TZ45.js";import"./hasown-B9bXSDSU.js";import"./call-bind-Aj7T_c8u.js";import"./set-function-length-Ct5B6P4y.js";import"./define-data-property-CUxyvwXF.js";import"./es-define-property-28jGrh5V.js";import"./gopd-O61WwtTx.js";import"./has-property-descriptors-Cvfij9iw.js";import"./object-inspect-DWoJJ4dO.js";import"./nprogress-BPhEN2Vg.js";import"./lodash.isequal-BYoXz8NH.js";import"./rc-util-BgYoB-iz.js";import"./react-is-DcfIKM1A.js";import"./classnames-CJuv6at9.js";import"./rc-resize-observer-CL6GnG8b.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-DZUdRcwm.js";import"./rc-tooltip-D7DGWIcy.js";import"./@rc-component-maQHxtPS.js";import"./rc-overflow-DTjLehDZ.js";import"./rc-select-AlqbObu9.js";import"./rc-virtual-list-CjLkEsa8.js";import"./rc-input-y5-WjU-O.js";import"./rc-textarea-DNapFda-.js";import"./rc-field-form-DQ7TiZ-c.js";import"./async-validator-DKvM95Vc.js";import"./@ctrl-DOFZgDuz.js";import"./rc-pagination-BHRJroNo.js";import"./rc-picker-XreuTR4e.js";import"./throttle-debounce-CWhimLW_.js";import"./@emotion-CW87jbl0.js";import"./stylis-DsJDcYJc.js";const U=({user:s})=>{const[x,m]=n.useState(100),[a,c]=n.useState(!1);n.useState("/chat-users");const[o,r]=n.useState([]),[i,d]=n.useState(0),[g,t]=n.useState(!0),p=()=>{a||(c(!0),d(i+1),j.get(`/chat-users?page=${i}`).then(l=>{m(l.data.total),m(l.data.total),l.data.last_page<=i&&t(!1),r([...o,...l.data.data]),c(!1)}).catch(l=>{c(!1)}))},h=()=>{};return n.useEffect(()=>{p()},[]),e.jsx("div",{id:"scrollableDiv",style:{height:630,overflow:"auto",padding:"0px 0px"},children:e.jsx(M,{dataLength:o.length,next:p,hasMore:g,loader:o.length>0?null:e.jsx(b,{avatar:!0,paragraph:{rows:1},active:!0}),endMessage:e.jsx(w,{plain:!0,children:"It is all, nothing more 🤐"}),scrollableTarget:"scrollableDiv",children:o&&e.jsx(f,{dataSource:o,renderItem:(l,v)=>e.jsx(N,{href:route("chat.user",l.id),children:e.jsx(f.Item,{style:{padding:"10px",gap:"0px"},className:(s==null?void 0:s.id)==l.id?"selected":"",onClick:h,children:e.jsx(f.Item.Meta,{avatar:e.jsx(u,{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRZyeylHD5tbJBruH48HgPdoKpmFsNJfBKXjhifVPO3gA&s"}),title:l==null?void 0:l.name,description:e.jsxs("div",{className:"mt-1 flex items-center gap-x-1.5 text-sm",children:[e.jsx("div",{className:"flex-none rounded-full bg-emerald-500/20 p-1",children:e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500"})}),e.jsx("p",{className:"text-xs leading-5 text-gray-500",children:"Online"})]})})},v)})})})})},C=({selected:s,setMessages:x})=>{const[m,a]=n.useState(""),c=o=>{(o.key==="Enter"||o.which===13)&&(m.trim(),j.post("/send/message",{message:m,receiver_id:s}).then(r=>{x(i=>[...i,r.data.message])}).catch(r=>{var i,d;console.log((d=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:d.message)}),a(""))};return e.jsx("div",{children:e.jsx(P,{className:"w-full",disabled:!s,placeholder:"Type your message and hit enter....",value:m,onChange:o=>a(o.target.value),onKeyDown:c})})},R=({align:s,message:x,textAlign:m,datetime:a})=>{const c=new Date(a),o=c.getHours(),r=c.getMinutes(),i=o>=12?"PM":"AM",d=o%12||12,g=r<10?"0"+r:r,t=`${d}:${g} ${i}`;return e.jsx("div",{className:`flex ${s}`,children:e.jsxs("div",{className:`${x} ${m}`,children:[x,e.jsx("br",{}),e.jsx("p",{className:"date text-gray-500 text-xs",children:t})]})})},T="",$="mt1";new H(T,{cluster:$,encrypted:!0});const qe=({auth:s,mustVerifyEmail:x,status:m,user:a,chats:c})=>{var g;const o=t=>{},r=n.useRef(null),[i,d]=n.useState([]);return(g=r.current)==null||g.scrollIntoView({behavior:"smooth"}),n.useEffect(()=>{d(c),window.Echo.private(`chat.${s.user.id}`).listen("MessageSent",t=>{r.current.scrollTop=0,console.log(t.message),d(p=>[...p,t.message])})},[]),n.useEffect(()=>{var t;(t=r.current)==null||t.scrollIntoView({behavior:"smooth"})},[i]),e.jsxs(y,{user:s.user,children:[e.jsx(S,{title:"Messenger"}),e.jsxs("div",{className:"chatContainer",children:[e.jsxs("div",{className:"chatUserList",children:[e.jsx(E,{placeholder:"Search User",allowClear:!0,onChange:o}),e.jsx(U,{user:a})]}),e.jsxs("div",{className:"chatBody",children:[e.jsxs("div",{className:"chatHeader",children:[e.jsx("div",{className:"chat-title",children:a?e.jsxs(e.Fragment,{children:[e.jsx(u,{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRZyeylHD5tbJBruH48HgPdoKpmFsNJfBKXjhifVPO3gA&s"}),a==null?void 0:a.name]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{}),"Messages"]})}),e.jsx(D,{})]}),e.jsxs("div",{className:"messages",children:[a?i==null?void 0:i.map(t=>{var p,h;return e.jsx(R,{align:(t==null?void 0:t.from)==((p=s==null?void 0:s.user)==null?void 0:p.id)?"justify-end":"justify-start",message:t==null?void 0:t.message,textAlign:(t==null?void 0:t.from)==((h=s==null?void 0:s.user)==null?void 0:h.id)?"text-right":"text-left",datetime:t==null?void 0:t.created_at},t==null?void 0:t.id)}):e.jsx("div",{className:"empty",children:e.jsx(I,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:e.jsxs("span",{children:["No user ",e.jsx("a",{href:"#API",children:"selected"})]})})}),e.jsx("div",{ref:r})]}),e.jsx("div",{className:"messageBox",children:e.jsx(C,{setMessages:d,selected:a==null?void 0:a.id})})]})]})]})};export{qe as default};
//# sourceMappingURL=Messenger-BLKbt7_Z.js.map

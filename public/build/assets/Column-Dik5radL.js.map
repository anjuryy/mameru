{"version":3,"file":"Column-Dik5radL.js","sources":["../../../resources/js/Pages/Kanban/Column.jsx"],"sourcesContent":["import { useState } from \"react\";\nimport AddCard from \"./AddCard\";\nimport Card from \"./Card\";\nimport DropIndicator from \"./DropIndicator\";\n\nconst Column = ({ title, headingColor, cards, column, setCards }) => {\n    const [active, setActive] = useState(false);\n\n    const handleDragStart = (e, card) => {\n        e.dataTransfer.setData(\"cardId\", card.id);\n    };\n\n    const handleDragEnd = (e) => {\n        const cardId = e.dataTransfer.getData(\"cardId\");\n\n        setActive(false);\n        clearHighlights();\n\n        const indicators = getIndicators();\n\n        console.log(column);\n        console.log(document.querySelectorAll(`[data-column=\"backlog\"]`));\n\n        const { element } = getNearestIndicator(e, indicators);\n\n        const before = element.dataset.before || \"-1\";\n\n        if (before !== cardId) {\n        let copy = [...cards];\n\n        let cardToTransfer = copy.find((c) => c.id === cardId);\n        if (!cardToTransfer) return;\n        cardToTransfer = { ...cardToTransfer, column };\n\n        copy = copy.filter((c) => c.id !== cardId);\n\n        const moveToBack = before === \"-1\";\n\n        if (moveToBack) {\n            copy.push(cardToTransfer);\n        } else {\n            const insertAtIndex = copy.findIndex((el) => el.id === before);\n            if (insertAtIndex === undefined) return;\n\n            copy.splice(insertAtIndex, 0, cardToTransfer);\n        }\n\n        setCards(copy);\n        }\n    };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    highlightIndicator(e);\n\n    setActive(true);\n  };\n\n  const clearHighlights = (els) => {\n    const indicators = els || getIndicators();\n\n    indicators.forEach((i) => {\n      i.style.opacity = \"0\";\n    });\n  };\n\n  const highlightIndicator = (e) => {\n    const indicators = getIndicators();\n\n    clearHighlights(indicators);\n\n    const el = getNearestIndicator(e, indicators);\n\n    el.element.style.opacity = \"1\";\n  };\n\n  const getNearestIndicator = (e, indicators) => {\n    const DISTANCE_OFFSET = 50;\n\n    const el = indicators.reduce(\n      (closest, child) => {\n        const box = child.getBoundingClientRect();\n\n        const offset = e.clientY - (box.top + DISTANCE_OFFSET);\n\n        if (offset < 0 && offset > closest.offset) {\n          return { offset: offset, element: child };\n        } else {\n          return closest;\n        }\n      },\n      {\n        offset: Number.NEGATIVE_INFINITY,\n        element: indicators[indicators.length - 1],\n      }\n    );\n\n    return el;\n  };\n\n  const getIndicators = () => {\n    // console.log(document.querySelectorAll(`[data-column=\"${column}\"]`));\n    return Array.from(document.querySelectorAll(`[data-column=\"${column}\"]`));\n  };\n\n  const handleDragLeave = () => {\n    clearHighlights();\n    setActive(false);\n  };\n\n  const filteredCards = cards.filter((c) => c.column === column);\n\n  return (\n    <div className=\"w-56 shrink-0\">\n      <div className=\"mb-3 flex items-center justify-between\">\n        <h3 className={`font-medium ${headingColor}`}>{title}</h3>\n        <span className=\"rounded text-sm text-neutral-400\">\n          {filteredCards.length}\n        </span>\n      </div>\n      <div\n        onDrop={handleDragEnd}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        className={`h-full w-full transition-colors ${\n          active ? \"bg-neutral-800/50\" : \"bg-neutral-800/0\"\n        }`}\n      >\n        {filteredCards.map((c) => {\n          return <Card key={c.id} {...c} handleDragStart={handleDragStart} />;\n        })}\n        {/* <DropIndicator beforeId={null} column={column} /> */}\n        <AddCard column={column} setCards={setCards} />\n      </div>\n    </div>\n  );\n};\n\nexport default Column\n"],"names":["Column","title","headingColor","cards","column","setCards","active","setActive","useState","handleDragStart","e","card","handleDragEnd","cardId","clearHighlights","indicators","getIndicators","element","getNearestIndicator","before","copy","cardToTransfer","c","insertAtIndex","el","handleDragOver","highlightIndicator","els","i","closest","child","box","offset","handleDragLeave","filteredCards","jsxs","jsx","Card","AddCard"],"mappings":"0oBAKM,MAAAA,EAAS,CAAC,CAAE,MAAAC,EAAO,aAAAC,EAAc,MAAAC,EAAO,OAAAC,EAAQ,SAAAC,KAAe,CACjE,KAAM,CAACC,EAAQC,CAAS,EAAIC,WAAS,EAAK,EAEpCC,EAAkB,CAACC,EAAGC,IAAS,CACjCD,EAAE,aAAa,QAAQ,SAAUC,EAAK,EAAE,CAAA,EAGtCC,EAAiBF,GAAM,CACzB,MAAMG,EAASH,EAAE,aAAa,QAAQ,QAAQ,EAE9CH,EAAU,EAAK,EACCO,IAEhB,MAAMC,EAAaC,IAEnB,QAAQ,IAAIZ,CAAM,EAClB,QAAQ,IAAI,SAAS,iBAAiB,yBAAyB,CAAC,EAEhE,KAAM,CAAE,QAAAa,CAAY,EAAAC,EAAoBR,EAAGK,CAAU,EAE/CI,EAASF,EAAQ,QAAQ,QAAU,KAEzC,GAAIE,IAAWN,EAAQ,CACnB,IAAAO,EAAO,CAAC,GAAGjB,CAAK,EAEhBkB,EAAiBD,EAAK,KAAME,GAAMA,EAAE,KAAOT,CAAM,EACrD,GAAI,CAACQ,EAAgB,OAOrB,GANiBA,EAAA,CAAE,GAAGA,EAAgB,OAAAjB,GAEtCgB,EAAOA,EAAK,OAAQE,GAAMA,EAAE,KAAOT,CAAM,EAEtBM,IAAW,KAG1BC,EAAK,KAAKC,CAAc,MACrB,CACH,MAAME,EAAgBH,EAAK,UAAWI,GAAOA,EAAG,KAAOL,CAAM,EAC7D,GAAII,IAAkB,OAAW,OAE5BH,EAAA,OAAOG,EAAe,EAAGF,CAAc,CAChD,CAEAhB,EAASe,CAAI,CACb,CAAA,EAGAK,EAAkBf,GAAM,CAC5BA,EAAE,eAAe,EACjBgB,EAAmBhB,CAAC,EAEpBH,EAAU,EAAI,CAAA,EAGVO,EAAmBa,GAAQ,EACZA,GAAOX,KAEf,QAASY,GAAM,CACxBA,EAAE,MAAM,QAAU,GAAA,CACnB,CAAA,EAGGF,EAAsBhB,GAAM,CAChC,MAAMK,EAAaC,IAEnBF,EAAgBC,CAAU,EAEpB,MAAAS,EAAKN,EAAoBR,EAAGK,CAAU,EAEzCS,EAAA,QAAQ,MAAM,QAAU,GAAA,EAGvBN,EAAsB,CAACR,EAAGK,IAGnBA,EAAW,OACpB,CAACc,EAASC,IAAU,CACZ,MAAAC,EAAMD,EAAM,wBAEZE,EAAStB,EAAE,SAAWqB,EAAI,IAAM,IAEtC,OAAIC,EAAS,GAAKA,EAASH,EAAQ,OAC1B,CAAE,OAAAG,EAAgB,QAASF,GAE3BD,CAEX,EACA,CACE,OAAQ,OAAO,kBACf,QAASd,EAAWA,EAAW,OAAS,CAAC,CAC3C,CAAA,EAMEC,EAAgB,IAEb,MAAM,KAAK,SAAS,iBAAiB,iBAAiBZ,CAAM,IAAI,CAAC,EAGpE6B,EAAkB,IAAM,CACZnB,IAChBP,EAAU,EAAK,CAAA,EAGX2B,EAAgB/B,EAAM,OAAQmB,GAAMA,EAAE,SAAWlB,CAAM,EAG3D,OAAA+B,EAAA,KAAC,MAAI,CAAA,UAAU,gBACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAC,MAAC,KAAG,CAAA,UAAW,eAAelC,CAAY,GAAK,SAAMD,EAAA,EACpDmC,EAAA,IAAA,OAAA,CAAK,UAAU,mCACb,WAAc,OACjB,CAAA,EACF,EACAD,EAAA,KAAC,MAAA,CACC,OAAQvB,EACR,WAAYa,EACZ,YAAaQ,EACb,UAAW,mCACT3B,EAAS,oBAAsB,kBACjC,GAEC,SAAA,CAAc4B,EAAA,IAAKZ,SACVe,EAAiB,CAAA,GAAGf,EAAG,gBAAAb,GAAba,EAAE,EAA6C,CAClE,EAEDc,EAAAA,IAACE,EAAQ,CAAA,OAAAlC,EAAgB,SAAAC,CAAoB,CAAA,CAAA,CAAA,CAC/C,CACF,CAAA,CAAA,CAEJ"}
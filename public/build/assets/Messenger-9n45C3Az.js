import{r as n,j as e}from"./react-DGeDUS3L.js";import{A as y}from"./AuthenticatedLayout-DpJbdTi3.js";import{d as N,a as S}from"./@inertiajs-AuzDUVoY.js";import{I as M}from"./react-infinite-scroll-component-B8M6b4lr.js";import{a as j}from"./axios-Di5RpEPX.js";import{S as b,D as w,L as f,A as u,I as E,E as I}from"./antd-DFxzdEUN.js";import{T as P}from"./TextInput-V3I2nGuQ.js";import{P as H}from"./pusher-js-D29SIy_X.js";import{M as A,I as D}from"./@ant-design-CqcPkJFB.js";import"./@react-three-BFRjeCcN.js";import"./@babel-CiGj-Vf4.js";import"./three-wFZZ4-aV.js";import"./react-use-measure-DO6L4M7M.js";import"./debounce-Bn9A2zky.js";import"./its-fine-fQHrmN5W.js";import"./react-reconciler-4d2z6Qt6.js";import"./react-dom-Bk3SHiAq.js";import"./scheduler-CzFDRTuY.js";import"./maath-CC4KLiXL.js";import"./three-stdlib-CSRvC8dv.js";import"./zustand-CwjNyJVO.js";import"./suspend-react-BKIKQNXN.js";import"./ApplicationLogo-hby-cl-L.js";import"./Dropdown-ByRnTpKt.js";import"./@headlessui-CPygwrpO.js";import"./deepmerge-D7I_G_I4.js";import"./qs-B99Nc6xW.js";import"./side-channel-Bz2OXirb.js";import"./get-intrinsic-B1Ut8WxJ.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-B8G-TZ45.js";import"./hasown-B9bXSDSU.js";import"./call-bind-Aj7T_c8u.js";import"./set-function-length-Ct5B6P4y.js";import"./define-data-property-CUxyvwXF.js";import"./es-define-property-28jGrh5V.js";import"./gopd-O61WwtTx.js";import"./has-property-descriptors-Cvfij9iw.js";import"./object-inspect-CJc8fbqy.js";import"./nprogress-DLlf1OgQ.js";import"./lodash.isequal-BLzkQ0eW.js";import"./rc-util-Cmemul9a.js";import"./react-is-DcfIKM1A.js";import"./classnames-Bp_uAGj2.js";import"./rc-resize-observer-CoGGhRo9.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-BG39Gvxk.js";import"./rc-tooltip-DysTJrr2.js";import"./@rc-component-DynfDMGQ.js";import"./rc-overflow-MHHbpKWc.js";import"./rc-select-U81fDAIh.js";import"./rc-virtual-list-Cn3iuzbQ.js";import"./rc-input-BEv45dWD.js";import"./rc-textarea-D9-WpXkn.js";import"./rc-field-form-BH833otm.js";import"./async-validator-DKvM95Vc.js";import"./@ctrl-DOFZgDuz.js";import"./rc-pagination-CNfhUKwI.js";import"./rc-picker-BPce-rLt.js";import"./throttle-debounce-CWhimLW_.js";import"./@emotion-CW87jbl0.js";import"./stylis-DsJDcYJc.js";const U=({user:s})=>{const[x,m]=n.useState(100),[a,c]=n.useState(!1);n.useState("/chat-users");const[o,r]=n.useState([]),[i,d]=n.useState(0),[g,t]=n.useState(!0),p=()=>{a||(c(!0),d(i+1),j.get(`/chat-users?page=${i}`).then(l=>{m(l.data.total),m(l.data.total),l.data.last_page<=i&&t(!1),r([...o,...l.data.data]),c(!1)}).catch(l=>{c(!1)}))},h=()=>{};return n.useEffect(()=>{p()},[]),e.jsx("div",{id:"scrollableDiv",style:{height:630,overflow:"auto",padding:"0px 0px"},children:e.jsx(M,{dataLength:o.length,next:p,hasMore:g,loader:o.length>0?null:e.jsx(b,{avatar:!0,paragraph:{rows:1},active:!0}),endMessage:e.jsx(w,{plain:!0,children:"It is all, nothing more 🤐"}),scrollableTarget:"scrollableDiv",children:o&&e.jsx(f,{dataSource:o,renderItem:(l,v)=>e.jsx(N,{href:route("chat.user",l.id),children:e.jsx(f.Item,{style:{padding:"10px",gap:"0px"},className:(s==null?void 0:s.id)==l.id?"selected":"",onClick:h,children:e.jsx(f.Item.Meta,{avatar:e.jsx(u,{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRZyeylHD5tbJBruH48HgPdoKpmFsNJfBKXjhifVPO3gA&s"}),title:l==null?void 0:l.name,description:e.jsxs("div",{className:"mt-1 flex items-center gap-x-1.5 text-sm",children:[e.jsx("div",{className:"flex-none rounded-full bg-emerald-500/20 p-1",children:e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500"})}),e.jsx("p",{className:"text-xs leading-5 text-gray-500",children:"Online"})]})})},v)})})})})},C=({selected:s,setMessages:x})=>{const[m,a]=n.useState(""),c=o=>{(o.key==="Enter"||o.which===13)&&(m.trim(),j.post("/send/message",{message:m,receiver_id:s}).then(r=>{x(i=>[...i,r.data.message])}).catch(r=>{var i,d;console.log((d=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:d.message)}),a(""))};return e.jsx("div",{children:e.jsx(P,{className:"w-full",disabled:!s,placeholder:"Type your message and hit enter....",value:m,onChange:o=>a(o.target.value),onKeyDown:c})})},R=({align:s,message:x,textAlign:m,datetime:a})=>{const c=new Date(a),o=c.getHours(),r=c.getMinutes(),i=o>=12?"PM":"AM",d=o%12||12,g=r<10?"0"+r:r,t=`${d}:${g} ${i}`;return e.jsx("div",{className:`flex ${s}`,children:e.jsxs("div",{className:`${x} ${m}`,children:[x,e.jsx("br",{}),e.jsx("p",{className:"date text-gray-500 text-xs",children:t})]})})},T="",$="mt1";new H(T,{cluster:$,encrypted:!0});const qe=({auth:s,mustVerifyEmail:x,status:m,user:a,chats:c})=>{var g;const o=t=>{},r=n.useRef(null),[i,d]=n.useState([]);return(g=r.current)==null||g.scrollIntoView({behavior:"smooth"}),n.useEffect(()=>{d(c),window.Echo.private(`chat.${s.user.id}`).listen("MessageSent",t=>{r.current.scrollTop=0,console.log(t.message),d(p=>[...p,t.message])})},[]),n.useEffect(()=>{var t;(t=r.current)==null||t.scrollIntoView({behavior:"smooth"})},[i]),e.jsxs(y,{user:s.user,children:[e.jsx(S,{title:"Messenger"}),e.jsxs("div",{className:"chatContainer",children:[e.jsxs("div",{className:"chatUserList",children:[e.jsx(E,{placeholder:"Search User",allowClear:!0,onChange:o}),e.jsx(U,{user:a})]}),e.jsxs("div",{className:"chatBody",children:[e.jsxs("div",{className:"chatHeader",children:[e.jsx("div",{className:"chat-title",children:a?e.jsxs(e.Fragment,{children:[e.jsx(u,{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRZyeylHD5tbJBruH48HgPdoKpmFsNJfBKXjhifVPO3gA&s"}),a==null?void 0:a.name]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{}),"Messages"]})}),e.jsx(D,{})]}),e.jsxs("div",{className:"messages",children:[a?i==null?void 0:i.map(t=>{var p,h;return e.jsx(R,{align:(t==null?void 0:t.from)==((p=s==null?void 0:s.user)==null?void 0:p.id)?"justify-end":"justify-start",message:t==null?void 0:t.message,textAlign:(t==null?void 0:t.from)==((h=s==null?void 0:s.user)==null?void 0:h.id)?"text-right":"text-left",datetime:t==null?void 0:t.created_at},t==null?void 0:t.id)}):e.jsx("div",{className:"empty",children:e.jsx(I,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:e.jsxs("span",{children:["No user ",e.jsx("a",{href:"#API",children:"selected"})]})})}),e.jsx("div",{ref:r})]}),e.jsx("div",{className:"messageBox",children:e.jsx(C,{setMessages:d,selected:a==null?void 0:a.id})})]})]})]})};export{qe as default};
//# sourceMappingURL=Messenger-9n45C3Az.js.map

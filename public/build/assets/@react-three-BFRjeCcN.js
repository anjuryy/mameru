import{g as N}from"./@babel-CiGj-Vf4.js";import{r as y}from"./react-DGeDUS3L.js";import{L as de,T as mt,R as ht,U as gt,B as yt,M as wt,C as We,a as bt,O as _t,P as Et,S as je,b as pe,N as Ct,A as Pt,W as St,c as Mt,d as Rt,e as xt,V as Ot,f as X,g as Ce,h as kt,i as Tt,j as jt,k as Lt,l as At,m as Me,n as It}from"./three-wFZZ4-aV.js";import{u as Dt}from"./react-use-measure-DO6L4M7M.js";import{F as Bt,u as Ft}from"./its-fine-fQHrmN5W.js";import{R as zt,c as Z}from"./react-reconciler-4d2z6Qt6.js";import{c as Ht}from"./react-dom-Bk3SHiAq.js";import{e as Le}from"./maath-CC4KLiXL.js";import{G as Re,D as Ut,M as ve,O as Nt,S as $t}from"./three-stdlib-CSRvC8dv.js";import{c as qt}from"./zustand-CwjNyJVO.js";import{s as Gt,p as Wt,c as Vt}from"./suspend-react-BKIKQNXN.js";const Xt="modulepreload",Yt=function(e){return"/build/"+e},Ae={},Fn=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){const f=document.getElementsByTagName("link"),m=document.querySelector("meta[property=csp-nonce]"),g=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));a=Promise.all(n.map(s=>{if(s=Yt(s),s in Ae)return;Ae[s]=!0;const h=s.endsWith(".css"),o=h?'[rel="stylesheet"]':"";if(!!r)for(let p=f.length-1;p>=0;p--){const d=f[p];if(d.href===s&&(!h||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const c=document.createElement("link");if(c.rel=h?"stylesheet":Xt,h||(c.as="script",c.crossOrigin=""),c.href=s,g&&c.setAttribute("nonce",g),document.head.appendChild(c),h)return new Promise((p,d)=>{c.addEventListener("load",p),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})}))}return a.then(()=>t()).catch(f=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=f,window.dispatchEvent(m),!m.defaultPrevented)throw f})};var zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Un(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),n}var Ve={exports:{}},Xe={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(b,R){var S=b.length;b.push(R);e:for(;0<S;){var k=S-1>>>1,A=b[k];if(0<a(A,R))b[k]=R,b[S]=A,S=k;else break e}}function n(b){return b.length===0?null:b[0]}function r(b){if(b.length===0)return null;var R=b[0],S=b.pop();if(S!==R){b[0]=S;e:for(var k=0,A=b.length,I=A>>>1;k<I;){var U=2*(k+1)-1,G=b[U],V=U+1,oe=b[V];if(0>a(G,S))V<A&&0>a(oe,G)?(b[k]=oe,b[V]=S,k=V):(b[k]=G,b[U]=S,k=U);else if(V<A&&0>a(oe,S))b[k]=oe,b[V]=S,k=V;else break e}}return R}function a(b,R){var S=b.sortIndex-R.sortIndex;return S!==0?S:b.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;e.unstable_now=function(){return f.now()}}else{var m=Date,g=m.now();e.unstable_now=function(){return m.now()-g}}var s=[],h=[],o=1,i=null,c=3,p=!1,d=!1,C=!1,v=typeof setTimeout=="function"?setTimeout:null,l=typeof clearTimeout=="function"?clearTimeout:null,u=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(b){for(var R=n(h);R!==null;){if(R.callback===null)r(h);else if(R.startTime<=b)r(h),R.sortIndex=R.expirationTime,t(s,R);else break;R=n(h)}}function M(b){if(C=!1,w(b),!d)if(n(s)!==null)d=!0,$(E);else{var R=n(h);R!==null&&q(M,R.startTime-b)}}function E(b,R){d=!1,C&&(C=!1,l(O),O=-1),p=!0;var S=c;try{for(w(R),i=n(s);i!==null&&(!(i.expirationTime>R)||b&&!_());){var k=i.callback;if(typeof k=="function"){i.callback=null,c=i.priorityLevel;var A=k(i.expirationTime<=R);R=e.unstable_now(),typeof A=="function"?i.callback=A:i===n(s)&&r(s),w(R)}else r(s);i=n(s)}if(i!==null)var I=!0;else{var U=n(h);U!==null&&q(M,U.startTime-R),I=!1}return I}finally{i=null,c=S,p=!1}}var P=!1,L=null,O=-1,T=5,x=-1;function _(){return!(e.unstable_now()-x<T)}function j(){if(L!==null){var b=e.unstable_now();x=b;var R=!0;try{R=L(!0,b)}finally{R?B():(P=!1,L=null)}}else P=!1}var B;if(typeof u=="function")B=function(){u(j)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,H=F.port2;F.port1.onmessage=j,B=function(){H.postMessage(null)}}else B=function(){v(j,0)};function $(b){L=b,P||(P=!0,B())}function q(b,R){O=v(function(){b(e.unstable_now())},R)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(b){b.callback=null},e.unstable_continueExecution=function(){d||p||(d=!0,$(E))},e.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<b?Math.floor(1e3/b):5},e.unstable_getCurrentPriorityLevel=function(){return c},e.unstable_getFirstCallbackNode=function(){return n(s)},e.unstable_next=function(b){switch(c){case 1:case 2:case 3:var R=3;break;default:R=c}var S=c;c=R;try{return b()}finally{c=S}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(b,R){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var S=c;c=b;try{return R()}finally{c=S}},e.unstable_scheduleCallback=function(b,R,S){var k=e.unstable_now();switch(typeof S=="object"&&S!==null?(S=S.delay,S=typeof S=="number"&&0<S?k+S:k):S=k,b){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=S+A,b={id:o++,callback:R,priorityLevel:b,startTime:S,expirationTime:A,sortIndex:-1},S>k?(b.sortIndex=S,t(h,b),n(s)===null&&b===n(h)&&(C?(l(O),O=-1):C=!0,q(M,S-k))):(b.sortIndex=A,t(s,b),d||p||(d=!0,$(E))),b},e.unstable_shouldYield=_,e.unstable_wrapCallback=function(b){var R=c;return function(){var S=c;c=R;try{return b.apply(this,arguments)}finally{c=S}}}})(Xe);Ve.exports=Xe;var Ie=Ve.exports;const xe={},Ye=e=>void Object.assign(xe,e);function Kt(e,t){function n(o,{args:i=[],attach:c,...p},d){let C=`${o[0].toUpperCase()}${o.slice(1)}`,v;if(o==="primitive"){if(p.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const l=p.object;v=J(l,{type:o,root:d,attach:c,primitive:!0})}else{const l=xe[C];if(!l)throw new Error(`R3F: ${C} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(i))throw new Error("R3F: The args prop must be an array!");v=J(new l(...i),{type:o,root:d,attach:c,memoizedProps:{args:i}})}return v.__r3f.attach===void 0&&(v instanceof yt?v.__r3f.attach="geometry":v instanceof wt&&(v.__r3f.attach="material")),C!=="inject"&&ge(v,p),v}function r(o,i){let c=!1;if(i){var p,d;(p=i.__r3f)!=null&&p.attach?he(o,i,i.__r3f.attach):i.isObject3D&&o.isObject3D&&(o.add(i),c=!0),c||(d=o.__r3f)==null||d.objects.push(i),i.__r3f||J(i,{}),i.__r3f.parent=o,Se(i),Q(i)}}function a(o,i,c){let p=!1;if(i){var d,C;if((d=i.__r3f)!=null&&d.attach)he(o,i,i.__r3f.attach);else if(i.isObject3D&&o.isObject3D){i.parent=o,i.dispatchEvent({type:"added"});const v=o.children.filter(u=>u!==i),l=v.indexOf(c);o.children=[...v.slice(0,l),i,...v.slice(l)],p=!0}p||(C=o.__r3f)==null||C.objects.push(i),i.__r3f||J(i,{}),i.__r3f.parent=o,Se(i),Q(i)}}function f(o,i,c=!1){o&&[...o].forEach(p=>m(i,p,c))}function m(o,i,c){if(i){var p,d,C;if(i.__r3f&&(i.__r3f.parent=null),(p=o.__r3f)!=null&&p.objects&&(o.__r3f.objects=o.__r3f.objects.filter(M=>M!==i)),(d=i.__r3f)!=null&&d.attach)He(o,i,i.__r3f.attach);else if(i.isObject3D&&o.isObject3D){var v;o.remove(i),(v=i.__r3f)!=null&&v.root&&sn(le(i),i)}const u=(C=i.__r3f)==null?void 0:C.primitive,w=!u&&(c===void 0?i.dispose!==null:c);if(!u){var l;f((l=i.__r3f)==null?void 0:l.objects,i,w),f(i.children,i,w)}if(delete i.__r3f,w&&i.dispose&&i.type!=="Scene"){const M=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?Ie.unstable_scheduleCallback(Ie.unstable_IdlePriority,M):M()}Q(o)}}function g(o,i,c,p){var d;const C=(d=o.__r3f)==null?void 0:d.parent;if(!C)return;const v=n(i,c,o.__r3f.root);if(o.children){for(const l of o.children)l.__r3f&&r(v,l);o.children=o.children.filter(l=>!l.__r3f)}o.__r3f.objects.forEach(l=>r(v,l)),o.__r3f.objects=[],o.__r3f.autoRemovedBeforeAppend||m(C,o),v.parent&&(v.__r3f.autoRemovedBeforeAppend=!0),r(C,v),v.raycast&&v.__r3f.eventCount&&le(v).getState().internal.interaction.push(v),[p,p.alternate].forEach(l=>{l!==null&&(l.stateNode=v,l.ref&&(typeof l.ref=="function"?l.ref(v):l.ref.current=v))})}const s=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:zt({createInstance:n,removeChild:m,appendChild:r,appendInitialChild:r,insertBefore:a,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(o,i)=>{if(!i)return;const c=o.getState().scene;c.__r3f&&(c.__r3f.root=o,r(c,i))},removeChildFromContainer:(o,i)=>{i&&m(o.getState().scene,i)},insertInContainerBefore:(o,i,c)=>{if(!i||!c)return;const p=o.getState().scene;p.__r3f&&a(p,i,c)},getRootHostContext:()=>null,getChildHostContext:o=>o,finalizeInitialChildren(o){var i;return!!((i=o==null?void 0:o.__r3f)!=null?i:{}).handlers},prepareUpdate(o,i,c,p){var d;if(((d=o==null?void 0:o.__r3f)!=null?d:{}).primitive&&p.object&&p.object!==o)return[!0];{const{args:v=[],children:l,...u}=p,{args:w=[],children:M,...E}=c;if(!Array.isArray(v))throw new Error("R3F: the args prop must be an array!");if(v.some((L,O)=>L!==w[O]))return[!0];const P=nt(o,u,E,!0);return P.changes.length?[!1,P]:null}},commitUpdate(o,[i,c],p,d,C,v){i?g(o,p,C,v):ge(o,c)},commitMount(o,i,c,p){var d;const C=(d=o.__r3f)!=null?d:{};o.raycast&&C.handlers&&C.eventCount&&le(o).getState().internal.interaction.push(o)},getPublicInstance:o=>o,prepareForCommit:()=>null,preparePortalMount:o=>J(o.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(o){var i;const{attach:c,parent:p}=(i=o.__r3f)!=null?i:{};c&&p&&He(p,o,c),o.isObject3D&&(o.visible=!1),Q(o)},unhideInstance(o,i){var c;const{attach:p,parent:d}=(c=o.__r3f)!=null?c:{};p&&d&&he(d,o,p),(o.isObject3D&&i.visible==null||i.visible)&&(o.visible=!0),Q(o)},createTextInstance:s,hideTextInstance:s,unhideTextInstance:s,getCurrentEventPriority:()=>t?t():Z.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&D.fun(performance.now)?performance.now:D.fun(Date.now)?Date.now:()=>0,scheduleTimeout:D.fun(setTimeout)?setTimeout:void 0,cancelTimeout:D.fun(clearTimeout)?clearTimeout:void 0}),applyProps:ge}}var De,Be;const me=e=>"colorSpace"in e||"outputColorSpace"in e,Ke=()=>{var e;return(e=xe.ColorManagement)!=null?e:null},Je=e=>e&&e.isOrthographicCamera,Jt=e=>e&&e.hasOwnProperty("current"),re=typeof window<"u"&&((De=window.document)!=null&&De.createElement||((Be=window.navigator)==null?void 0:Be.product)==="ReactNative")?y.useLayoutEffect:y.useEffect;function Qe(e){const t=y.useRef(e);return re(()=>void(t.current=e),[e]),t}function Qt({set:e}){return re(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class Ze extends y.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}Ze.getDerivedStateFromError=()=>({error:!0});const et="__default",Fe=new Map,Zt=e=>e&&!!e.memoized&&!!e.changes;function tt(e){var t;const n=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const te=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()};function le(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const D={obj:e=>e===Object(e)&&!D.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:a=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(D.str(e)||D.num(e))return e===t;const f=D.obj(e);if(f&&r==="reference")return e===t;const m=D.arr(e);if(m&&n==="reference")return e===t;if((m||f)&&e===t)return!0;let g;for(g in e)if(!(g in t))return!1;if(f&&n==="shallow"&&r==="shallow"){for(g in a?t:e)if(!D.equ(e[g],t[g],{strict:a,objects:"reference"}))return!1}else for(g in a?t:e)if(e[g]!==t[g])return!1;if(D.und(g)){if(m&&e.length===0&&t.length===0||f&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function en(e){const t={nodes:{},materials:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material)}),t}function tn(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function J(e,t){const n=e;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function Pe(e,t){let n=e;if(t.includes("-")){const r=t.split("-"),a=r.pop();return n=r.reduce((f,m)=>f[m],e),{target:n,key:a}}else return{target:n,key:t}}const ze=/-\d+$/;function he(e,t,n){if(D.str(n)){if(ze.test(n)){const f=n.replace(ze,""),{target:m,key:g}=Pe(e,f);Array.isArray(m[g])||(m[g]=[])}const{target:r,key:a}=Pe(e,n);t.__r3f.previousAttach=r[a],r[a]=t}else t.__r3f.previousAttach=n(e,t)}function He(e,t,n){var r,a;if(D.str(n)){const{target:f,key:m}=Pe(e,n),g=t.__r3f.previousAttach;g===void 0?delete f[m]:f[m]=g}else(r=t.__r3f)==null||r.previousAttach==null||r.previousAttach(e,t);(a=t.__r3f)==null||delete a.previousAttach}function nt(e,{children:t,key:n,ref:r,...a},{children:f,key:m,ref:g,...s}={},h=!1){var o;const i=(o=e==null?void 0:e.__r3f)!=null?o:{},c=Object.entries(a),p=[];if(h){const C=Object.keys(s);for(let v=0;v<C.length;v++)a.hasOwnProperty(C[v])||c.unshift([C[v],et+"remove"])}c.forEach(([C,v])=>{var l;if((l=e.__r3f)!=null&&l.primitive&&C==="object"||D.equ(v,s[C]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(C))return p.push([C,v,!0,[]]);let u=[];C.includes("-")&&(u=C.split("-")),p.push([C,v,!1,u]);for(const w in a){const M=a[w];w.startsWith(`${C}-`)&&p.push([w,M,!1,w.split("-")])}});const d={...a};return i.memoizedProps&&i.memoizedProps.args&&(d.args=i.memoizedProps.args),i.memoizedProps&&i.memoizedProps.attach&&(d.attach=i.memoizedProps.attach),{memoized:d,changes:p}}const nn=typeof process<"u"&&!1;function ge(e,t){var n,r,a;const f=(n=e.__r3f)!=null?n:{},m=f.root,g=(r=m==null||m.getState==null?void 0:m.getState())!=null?r:{},{memoized:s,changes:h}=Zt(t)?t:nt(e,t),o=f.eventCount;e.__r3f&&(e.__r3f.memoizedProps=s);for(let c=0;c<h.length;c++){let[p,d,C,v]=h[c];if(me(e)){const M="srgb",E="srgb-linear";p==="encoding"?(p="colorSpace",d=d===3001?M:E):p==="outputEncoding"&&(p="outputColorSpace",d=d===3001?M:E)}let l=e,u=l[p];if(v.length&&(u=v.reduce((w,M)=>w[M],e),!(u&&u.set))){const[w,...M]=v.reverse();l=M.reverse().reduce((E,P)=>E[P],e),p=w}if(d===et+"remove")if(l.constructor){let w=Fe.get(l.constructor);w||(w=new l.constructor,Fe.set(l.constructor,w)),d=w[p]}else d=0;if(C)d?f.handlers[p]=d:delete f.handlers[p],f.eventCount=Object.keys(f.handlers).length;else if(u&&u.set&&(u.copy||u instanceof de)){if(Array.isArray(d))u.fromArray?u.fromArray(d):u.set(...d);else if(u.copy&&d&&d.constructor&&(nn?u.constructor.name===d.constructor.name:u.constructor===d.constructor))u.copy(d);else if(d!==void 0){const w=u instanceof We;!w&&u.setScalar?u.setScalar(d):u instanceof de&&d instanceof de?u.mask=d.mask:u.set(d),!Ke()&&!g.linear&&w&&u.convertSRGBToLinear()}}else if(l[p]=d,l[p]instanceof mt&&l[p].format===ht&&l[p].type===gt){const w=l[p];me(w)&&me(g.gl)?w.colorSpace=g.gl.outputColorSpace:w.encoding=g.gl.outputEncoding}Q(e)}if(f.parent&&e.raycast&&o!==f.eventCount){const c=le(e).getState().internal,p=c.interaction.indexOf(e);p>-1&&c.interaction.splice(p,1),f.eventCount&&c.interaction.push(e)}return!(h.length===1&&h[0][0]==="onUpdate")&&h.length&&(a=e.__r3f)!=null&&a.parent&&Se(e),e}function Q(e){var t,n;const r=(t=e.__r3f)==null||(n=t.root)==null||n.getState==null?void 0:n.getState();r&&r.internal.frames===0&&r.invalidate()}function Se(e){e.onUpdate==null||e.onUpdate(e)}function rn(e,t){e.manual||(Je(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function ie(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function on(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return Z.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Z.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Z.ContinuousEventPriority;default:return Z.DefaultEventPriority}}function rt(e,t,n,r){const a=n.get(t);a&&(n.delete(t),n.size===0&&(e.delete(r),a.target.releasePointerCapture(r)))}function sn(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(r=>r!==t),n.initialHits=n.initialHits.filter(r=>r!==t),n.hovered.forEach((r,a)=>{(r.eventObject===t||r.object===t)&&n.hovered.delete(a)}),n.capturedMap.forEach((r,a)=>{rt(n.capturedMap,t,r,a)})}function an(e){function t(s){const{internal:h}=e.getState(),o=s.offsetX-h.initialClick[0],i=s.offsetY-h.initialClick[1];return Math.round(Math.sqrt(o*o+i*i))}function n(s){return s.filter(h=>["Move","Over","Enter","Out","Leave"].some(o=>{var i;return(i=h.__r3f)==null?void 0:i.handlers["onPointer"+o]}))}function r(s,h){const o=e.getState(),i=new Set,c=[],p=h?h(o.internal.interaction):o.internal.interaction;for(let l=0;l<p.length;l++){const u=te(p[l]);u&&(u.raycaster.camera=void 0)}o.previousRoot||o.events.compute==null||o.events.compute(s,o);function d(l){const u=te(l);if(!u||!u.events.enabled||u.raycaster.camera===null)return[];if(u.raycaster.camera===void 0){var w;u.events.compute==null||u.events.compute(s,u,(w=u.previousRoot)==null?void 0:w.getState()),u.raycaster.camera===void 0&&(u.raycaster.camera=null)}return u.raycaster.camera?u.raycaster.intersectObject(l,!0):[]}let C=p.flatMap(d).sort((l,u)=>{const w=te(l.object),M=te(u.object);return!w||!M?l.distance-u.distance:M.events.priority-w.events.priority||l.distance-u.distance}).filter(l=>{const u=ie(l);return i.has(u)?!1:(i.add(u),!0)});o.events.filter&&(C=o.events.filter(C,o));for(const l of C){let u=l.object;for(;u;){var v;(v=u.__r3f)!=null&&v.eventCount&&c.push({...l,eventObject:u}),u=u.parent}}if("pointerId"in s&&o.internal.capturedMap.has(s.pointerId))for(let l of o.internal.capturedMap.get(s.pointerId).values())i.has(ie(l.intersection))||c.push(l.intersection);return c}function a(s,h,o,i){const c=e.getState();if(s.length){const p={stopped:!1};for(const d of s){const C=te(d.object)||c,{raycaster:v,pointer:l,camera:u,internal:w}=C,M=new X(l.x,l.y,0).unproject(u),E=x=>{var _,j;return(_=(j=w.capturedMap.get(x))==null?void 0:j.has(d.eventObject))!=null?_:!1},P=x=>{const _={intersection:d,target:h.target};w.capturedMap.has(x)?w.capturedMap.get(x).set(d.eventObject,_):w.capturedMap.set(x,new Map([[d.eventObject,_]])),h.target.setPointerCapture(x)},L=x=>{const _=w.capturedMap.get(x);_&&rt(w.capturedMap,d.eventObject,_,x)};let O={};for(let x in h){let _=h[x];typeof _!="function"&&(O[x]=_)}let T={...d,...O,pointer:l,intersections:s,stopped:p.stopped,delta:o,unprojectedPoint:M,ray:v.ray,camera:u,stopPropagation(){const x="pointerId"in h&&w.capturedMap.get(h.pointerId);if((!x||x.has(d.eventObject))&&(T.stopped=p.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(_=>_.eventObject===d.eventObject))){const _=s.slice(0,s.indexOf(d));f([..._,d])}},target:{hasPointerCapture:E,setPointerCapture:P,releasePointerCapture:L},currentTarget:{hasPointerCapture:E,setPointerCapture:P,releasePointerCapture:L},nativeEvent:h};if(i(T),p.stopped===!0)break}}return s}function f(s){const{internal:h}=e.getState();for(const o of h.hovered.values())if(!s.length||!s.find(i=>i.object===o.object&&i.index===o.index&&i.instanceId===o.instanceId)){const c=o.eventObject.__r3f,p=c==null?void 0:c.handlers;if(h.hovered.delete(ie(o)),c!=null&&c.eventCount){const d={...o,intersections:s};p.onPointerOut==null||p.onPointerOut(d),p.onPointerLeave==null||p.onPointerLeave(d)}}}function m(s,h){for(let o=0;o<h.length;o++){const i=h[o].__r3f;i==null||i.handlers.onPointerMissed==null||i.handlers.onPointerMissed(s)}}function g(s){switch(s){case"onPointerLeave":case"onPointerCancel":return()=>f([]);case"onLostPointerCapture":return h=>{const{internal:o}=e.getState();"pointerId"in h&&o.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{o.capturedMap.has(h.pointerId)&&(o.capturedMap.delete(h.pointerId),f([]))})}}return function(o){const{onPointerMissed:i,internal:c}=e.getState();c.lastEvent.current=o;const p=s==="onPointerMove",d=s==="onClick"||s==="onContextMenu"||s==="onDoubleClick",v=r(o,p?n:void 0),l=d?t(o):0;s==="onPointerDown"&&(c.initialClick=[o.offsetX,o.offsetY],c.initialHits=v.map(w=>w.eventObject)),d&&!v.length&&l<=2&&(m(o,c.interaction),i&&i(o)),p&&f(v);function u(w){const M=w.eventObject,E=M.__r3f,P=E==null?void 0:E.handlers;if(E!=null&&E.eventCount)if(p){if(P.onPointerOver||P.onPointerEnter||P.onPointerOut||P.onPointerLeave){const L=ie(w),O=c.hovered.get(L);O?O.stopped&&w.stopPropagation():(c.hovered.set(L,w),P.onPointerOver==null||P.onPointerOver(w),P.onPointerEnter==null||P.onPointerEnter(w))}P.onPointerMove==null||P.onPointerMove(w)}else{const L=P[s];L?(!d||c.initialHits.includes(M))&&(m(o,c.interaction.filter(O=>!c.initialHits.includes(O))),L(w)):d&&c.initialHits.includes(M)&&m(o,c.interaction.filter(O=>!c.initialHits.includes(O)))}}a(v,o,l,u)}}return{handlePointer:g}}const ot=e=>!!(e!=null&&e.render),ce=y.createContext(null),ln=(e,t)=>{const n=qt((g,s)=>{const h=new X,o=new X,i=new X;function c(l=s().camera,u=o,w=s().size){const{width:M,height:E,top:P,left:L}=w,O=M/E;u instanceof X?i.copy(u):i.set(...u);const T=l.getWorldPosition(h).distanceTo(i);if(Je(l))return{width:M/l.zoom,height:E/l.zoom,top:P,left:L,factor:1,distance:T,aspect:O};{const x=l.fov*Math.PI/180,_=2*Math.tan(x/2)*T,j=_*(M/E);return{width:j,height:_,top:P,left:L,factor:M/j,distance:T,aspect:O}}}let p;const d=l=>g(u=>({performance:{...u.performance,current:l}})),C=new Ce;return{set:g,get:s,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(l=1)=>e(s(),l),advance:(l,u)=>t(l,u,s()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new kt,pointer:C,mouse:C,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const l=s();p&&clearTimeout(p),l.performance.current!==l.performance.min&&d(l.performance.min),p=setTimeout(()=>d(s().performance.max),l.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:c},setEvents:l=>g(u=>({...u,events:{...u.events,...l}})),setSize:(l,u,w,M,E)=>{const P=s().camera,L={width:l,height:u,top:M||0,left:E||0,updateStyle:w};g(O=>({size:L,viewport:{...O.viewport,...c(P,o,L)}}))},setDpr:l=>g(u=>{const w=tt(l);return{viewport:{...u.viewport,dpr:w,initialDpr:u.viewport.initialDpr||w}}}),setFrameloop:(l="always")=>{const u=s().clock;u.stop(),u.elapsedTime=0,l!=="never"&&(u.start(),u.elapsedTime=0),g(()=>({frameloop:l}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:y.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(l,u,w)=>{const M=s().internal;return M.priority=M.priority+(u>0?1:0),M.subscribers.push({ref:l,priority:u,store:w}),M.subscribers=M.subscribers.sort((E,P)=>E.priority-P.priority),()=>{const E=s().internal;E!=null&&E.subscribers&&(E.priority=E.priority-(u>0?1:0),E.subscribers=E.subscribers.filter(P=>P.ref!==l))}}}}}),r=n.getState();let a=r.size,f=r.viewport.dpr,m=r.camera;return n.subscribe(()=>{const{camera:g,size:s,viewport:h,gl:o,set:i}=n.getState();if(s.width!==a.width||s.height!==a.height||h.dpr!==f){var c;a=s,f=h.dpr,rn(g,s),o.setPixelRatio(h.dpr);const p=(c=s.updateStyle)!=null?c:typeof HTMLCanvasElement<"u"&&o.domElement instanceof HTMLCanvasElement;o.setSize(s.width,s.height,p)}g!==m&&(m=g,i(p=>({viewport:{...p.viewport,...p.viewport.getCurrentViewport(g)}})))}),n.subscribe(g=>e(g)),n};function it(e,t){const n={callback:e};return t.add(n),()=>void t.delete(n)}let se,st=new Set,at=new Set,cn=new Set;const un=e=>it(e,st),fn=e=>it(e,at);function ye(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function ne(e,t){switch(e){case"before":return ye(st,t);case"after":return ye(at,t);case"tail":return ye(cn,t)}}let we,be;function _e(e,t,n){let r=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),we=t.internal.subscribers,se=0;se<we.length;se++)be=we[se],be.ref.current(be.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function dn(e){let t=!1,n,r,a;function f(s){r=requestAnimationFrame(f),t=!0,n=0,ne("before",s);for(const o of e.values()){var h;a=o.store.getState(),a.internal.active&&(a.frameloop==="always"||a.internal.frames>0)&&!((h=a.gl.xr)!=null&&h.isPresenting)&&(n+=_e(s,a))}if(ne("after",s),n===0)return ne("tail",s),t=!1,cancelAnimationFrame(r)}function m(s,h=1){var o;if(!s)return e.forEach(i=>m(i.store.getState(),h));(o=s.gl.xr)!=null&&o.isPresenting||!s.internal.active||s.frameloop==="never"||(s.internal.frames=Math.min(60,s.internal.frames+h),t||(t=!0,requestAnimationFrame(f)))}function g(s,h=!0,o,i){if(h&&ne("before",s),o)_e(s,o,i);else for(const c of e.values())_e(s,c.store.getState());h&&ne("after",s)}return{loop:f,invalidate:m,advance:g}}function lt(){const e=y.useContext(ce);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function z(e=n=>n,t){return lt()(e,t)}function fe(e,t=0){const n=lt(),r=n.getState().internal.subscribe,a=Qe(e);return re(()=>r(a,t,n),[t,r,n]),null}const Ue=new WeakMap;function ct(e,t){return function(n,...r){let a=Ue.get(n);return a||(a=new n,Ue.set(n,a)),e&&e(a),Promise.all(r.map(f=>new Promise((m,g)=>a.load(f,s=>{s.scene&&Object.assign(s,en(s.scene)),m(s)},t,s=>g(new Error(`Could not load ${f}: ${s==null?void 0:s.message}`)))))).finally(()=>a.dispose==null?void 0:a.dispose())}}function W(e,t,n,r){const a=Array.isArray(t)?t:[t],f=Gt(ct(n,r),[e,...a],{equal:D.equ});return Array.isArray(t)?f:f[0]}W.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return Wt(ct(n),[e,...r])};W.clear=function(e,t){const n=Array.isArray(t)?t:[t];return Vt([e,...n])};const ee=new Map,{invalidate:Ne,advance:$e}=dn(ee),{reconciler:ue,applyProps:Y}=Kt(ee,on),K={objects:"shallow",strict:!1},pn=(e,t)=>{const n=typeof e=="function"?e(t):e;return ot(n)?n:new St({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function vn(e,t){const n=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:r,height:a,top:f,left:m,updateStyle:g=n}=t;return{width:r,height:a,top:f,left:m,updateStyle:g}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:r,height:a,top:f,left:m}=e.parentElement.getBoundingClientRect();return{width:r,height:a,top:f,left:m,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function mn(e){const t=ee.get(e),n=t==null?void 0:t.fiber,r=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const a=typeof reportError=="function"?reportError:console.error,f=r||ln(Ne,$e),m=n||ue.createContainer(f,Z.ConcurrentRoot,null,!1,null,"",a,null);t||ee.set(e,{fiber:m,store:f});let g,s=!1,h;return{configure(o={}){let{gl:i,size:c,scene:p,events:d,onCreated:C,shadows:v=!1,linear:l=!1,flat:u=!1,legacy:w=!1,orthographic:M=!1,frameloop:E="always",dpr:P=[1,2],performance:L,raycaster:O,camera:T,onPointerMissed:x}=o,_=f.getState(),j=_.gl;_.gl||_.set({gl:j=pn(i,e)});let B=_.raycaster;B||_.set({raycaster:B=new bt});const{params:F,...H}=O||{};if(D.equ(H,B,K)||Y(B,{...H}),D.equ(F,B.params,K)||Y(B,{params:{...B.params,...F}}),!_.camera||_.camera===h&&!D.equ(h,T,K)){h=T;const S=T instanceof Mt,k=S?T:M?new _t(0,0,0,0,.1,1e3):new Et(75,0,.1,1e3);S||(k.position.z=5,T&&Y(k,T),!_.camera&&!(T!=null&&T.rotation)&&k.lookAt(0,0,0)),_.set({camera:k}),B.camera=k}if(!_.scene){let S;p instanceof je?S=p:(S=new je,p&&Y(S,p)),_.set({scene:J(S)})}if(!_.xr){var $;const S=(I,U)=>{const G=f.getState();G.frameloop!=="never"&&$e(I,!0,G,U)},k=()=>{const I=f.getState();I.gl.xr.enabled=I.gl.xr.isPresenting,I.gl.xr.setAnimationLoop(I.gl.xr.isPresenting?S:null),I.gl.xr.isPresenting||Ne(I)},A={connect(){const I=f.getState().gl;I.xr.addEventListener("sessionstart",k),I.xr.addEventListener("sessionend",k)},disconnect(){const I=f.getState().gl;I.xr.removeEventListener("sessionstart",k),I.xr.removeEventListener("sessionend",k)}};typeof(($=j.xr)==null?void 0:$.addEventListener)=="function"&&A.connect(),_.set({xr:A})}if(j.shadowMap){const S=j.shadowMap.enabled,k=j.shadowMap.type;if(j.shadowMap.enabled=!!v,D.boo(v))j.shadowMap.type=pe;else if(D.str(v)){var q;const A={basic:Rt,percentage:xt,soft:pe,variance:Ot};j.shadowMap.type=(q=A[v])!=null?q:pe}else D.obj(v)&&Object.assign(j.shadowMap,v);(S!==j.shadowMap.enabled||k!==j.shadowMap.type)&&(j.shadowMap.needsUpdate=!0)}const b=Ke();b&&("enabled"in b?b.enabled=!w:"legacyMode"in b&&(b.legacyMode=w)),s||Y(j,{outputEncoding:l?3e3:3001,toneMapping:u?Ct:Pt}),_.legacy!==w&&_.set(()=>({legacy:w})),_.linear!==l&&_.set(()=>({linear:l})),_.flat!==u&&_.set(()=>({flat:u})),i&&!D.fun(i)&&!ot(i)&&!D.equ(i,j,K)&&Y(j,i),d&&!_.events.handlers&&_.set({events:d(f)});const R=vn(e,c);return D.equ(R,_.size,K)||_.setSize(R.width,R.height,R.updateStyle,R.top,R.left),P&&_.viewport.dpr!==tt(P)&&_.setDpr(P),_.frameloop!==E&&_.setFrameloop(E),_.onPointerMissed||_.set({onPointerMissed:x}),L&&!D.equ(L,_.performance,K)&&_.set(S=>({performance:{...S.performance,...L}})),g=C,s=!0,this},render(o){return s||this.configure(),ue.updateContainer(y.createElement(hn,{store:f,children:o,onCreated:g,rootElement:e}),m,null,()=>{}),f},unmount(){ut(e)}}}function hn({store:e,children:t,onCreated:n,rootElement:r}){return re(()=>{const a=e.getState();a.set(f=>({internal:{...f.internal,active:!0}})),n&&n(a),e.getState().events.connected||a.events.connect==null||a.events.connect(r)},[]),y.createElement(ce.Provider,{value:e},t)}function ut(e,t){const n=ee.get(e),r=n==null?void 0:n.fiber;if(r){const a=n==null?void 0:n.store.getState();a&&(a.internal.active=!1),ue.updateContainer(null,r,null,()=>{a&&setTimeout(()=>{try{var f,m,g,s;a.events.disconnect==null||a.events.disconnect(),(f=a.gl)==null||(m=f.renderLists)==null||m.dispose==null||m.dispose(),(g=a.gl)==null||g.forceContextLoss==null||g.forceContextLoss(),(s=a.gl)!=null&&s.xr&&a.xr.disconnect(),tn(a),ee.delete(e),t&&t(e)}catch{}},500)})}}ue.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:y.version});const Ee={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function gn(e){const{handlePointer:t}=an(e);return{priority:1,enabled:!0,compute(n,r,a){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(Ee).reduce((n,r)=>({...n,[r]:t(r)}),{}),update:()=>{var n;const{events:r,internal:a}=e.getState();(n=a.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(a.lastEvent.current)},connect:n=>{var r;const{set:a,events:f}=e.getState();f.disconnect==null||f.disconnect(),a(m=>({events:{...m.events,connected:n}})),Object.entries((r=f.handlers)!=null?r:[]).forEach(([m,g])=>{const[s,h]=Ee[m];n.addEventListener(s,g,{passive:h})})},disconnect:()=>{const{set:n,events:r}=e.getState();if(r.connected){var a;Object.entries((a=r.handlers)!=null?a:[]).forEach(([f,m])=>{if(r&&r.connected instanceof HTMLElement){const[g]=Ee[f];r.connected.removeEventListener(g,m)}}),n(f=>({events:{...f.events,connected:void 0}}))}}}}const yn=y.forwardRef(function({children:t,fallback:n,resize:r,style:a,gl:f,events:m=gn,eventSource:g,eventPrefix:s,shadows:h,linear:o,flat:i,legacy:c,orthographic:p,frameloop:d,dpr:C,performance:v,raycaster:l,camera:u,scene:w,onPointerMissed:M,onCreated:E,...P},L){y.useMemo(()=>Ye(Tt),[]);const O=Ft(),[T,x]=Dt({scroll:!0,debounce:{scroll:50,resize:0},...r}),_=y.useRef(null),j=y.useRef(null);y.useImperativeHandle(L,()=>_.current);const B=Qe(M),[F,H]=y.useState(!1),[$,q]=y.useState(!1);if(F)throw F;if($)throw $;const b=y.useRef(null);re(()=>{const S=_.current;x.width>0&&x.height>0&&S&&(b.current||(b.current=mn(S)),b.current.configure({gl:f,events:m,shadows:h,linear:o,flat:i,legacy:c,orthographic:p,frameloop:d,dpr:C,performance:v,raycaster:l,camera:u,scene:w,size:x,onPointerMissed:(...k)=>B.current==null?void 0:B.current(...k),onCreated:k=>{k.events.connect==null||k.events.connect(g?Jt(g)?g.current:g:j.current),s&&k.setEvents({compute:(A,I)=>{const U=A[s+"X"],G=A[s+"Y"];I.pointer.set(U/I.size.width*2-1,-(G/I.size.height)*2+1),I.raycaster.setFromCamera(I.pointer,I.camera)}}),E==null||E(k)}}),b.current.render(y.createElement(O,null,y.createElement(Ze,{set:q},y.createElement(y.Suspense,{fallback:y.createElement(Qt,{set:H})},t)))))}),y.useEffect(()=>{const S=_.current;if(S)return()=>ut(S)},[]);const R=g?"none":"auto";return y.createElement("div",N({ref:j,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:R,...a}},P),y.createElement("div",{ref:T,style:{width:"100%",height:"100%"}},y.createElement("canvas",{ref:_,style:{display:"block"}},n)))}),Nn=y.forwardRef(function(t,n){return y.createElement(Bt,null,y.createElement(yn,N({},t,{ref:n})))}),Oe=y.createContext(null);function ft(){return y.useContext(Oe)}function $n({eps:e=1e-5,enabled:t=!0,infinite:n,horizontal:r,pages:a=1,distance:f=1,damping:m=.25,maxSpeed:g=1/0,style:s={},children:h}){const{get:o,setEvents:i,gl:c,size:p,invalidate:d,events:C}=z(),[v]=y.useState(()=>document.createElement("div")),[l]=y.useState(()=>document.createElement("div")),[u]=y.useState(()=>document.createElement("div")),w=c.domElement.parentNode,M=y.useRef(0),E=y.useMemo(()=>({el:v,eps:e,fill:l,fixed:u,horizontal:r,damping:m,offset:0,delta:0,scroll:M,pages:a,range(O,T,x=0){const _=O-x,j=_+T+x*2;return this.offset<_?0:this.offset>j?1:(this.offset-_)/(j-_)},curve(O,T,x=0){return Math.sin(this.range(O,T,x)*Math.PI)},visible(O,T,x=0){const _=O-x,j=_+T+x*2;return this.offset>=_&&this.offset<=j}}),[e,m,r,a]);y.useEffect(()=>{v.style.position="absolute",v.style.width="100%",v.style.height="100%",v.style[r?"overflowX":"overflowY"]="auto",v.style[r?"overflowY":"overflowX"]="hidden",v.style.top="0px",v.style.left="0px";for(const T in s)v.style[T]=s[T];u.style.position="sticky",u.style.top="0px",u.style.left="0px",u.style.width="100%",u.style.height="100%",u.style.overflow="hidden",v.appendChild(u),l.style.height=r?"100%":`${a*f*100}%`,l.style.width=r?`${a*f*100}%`:"100%",l.style.pointerEvents="none",v.appendChild(l),w.appendChild(v),v[r?"scrollLeft":"scrollTop"]=1;const L=C.connected||c.domElement;requestAnimationFrame(()=>C.connect==null?void 0:C.connect(v));const O=o().events.compute;return i({compute(T,x){const{left:_,top:j}=w.getBoundingClientRect(),B=T.clientX-_,F=T.clientY-j;x.pointer.set(B/x.size.width*2-1,-(F/x.size.height)*2+1),x.raycaster.setFromCamera(x.pointer,x.camera)}}),()=>{w.removeChild(v),i({compute:O}),C.connect==null||C.connect(L)}},[a,f,r,v,l,u,w]),y.useEffect(()=>{if(C.connected===v){const L=p[r?"width":"height"],O=v[r?"scrollWidth":"scrollHeight"],T=O-L;let x=0,_=!0,j=!0;const B=()=>{if(!(!t||j)&&(d(),x=v[r?"scrollLeft":"scrollTop"],M.current=x/T,n)){if(!_){if(x>=T){const H=1-E.offset;v[r?"scrollLeft":"scrollTop"]=1,M.current=E.offset=-H,_=!0}else if(x<=0){const H=1+E.offset;v[r?"scrollLeft":"scrollTop"]=O,M.current=E.offset=H,_=!0}}_&&setTimeout(()=>_=!1,40)}};v.addEventListener("scroll",B,{passive:!0}),requestAnimationFrame(()=>j=!1);const F=H=>v.scrollLeft+=H.deltaY/2;return r&&v.addEventListener("wheel",F,{passive:!0}),()=>{v.removeEventListener("scroll",B),r&&v.removeEventListener("wheel",F)}}},[v,C,p,n,E,d,r,t]);let P=0;return fe((L,O)=>{P=E.offset,Le.damp(E,"offset",M.current,m,O,g,void 0,e),Le.damp(E,"delta",Math.abs(P-E.offset),m,O,g,void 0,e),E.delta>e&&d()}),y.createElement(Oe.Provider,{value:E},h)}const wn=y.forwardRef(({children:e},t)=>{const n=y.useRef(null);y.useImperativeHandle(t,()=>n.current,[]);const r=ft(),{width:a,height:f}=z(m=>m.viewport);return fe(()=>{n.current.position.x=r.horizontal?-a*(r.pages-1)*r.offset:0,n.current.position.y=r.horizontal?0:f*(r.pages-1)*r.offset}),y.createElement("group",{ref:n},e)}),bn=y.forwardRef(({children:e,style:t,...n},r)=>{const a=ft(),f=y.useRef(null);y.useImperativeHandle(r,()=>f.current,[]);const{width:m,height:g}=z(o=>o.size),s=y.useContext(ce),h=y.useMemo(()=>Ht(a.fixed),[a.fixed]);return fe(()=>{a.delta>a.eps&&(f.current.style.transform=`translate3d(${a.horizontal?-m*(a.pages-1)*a.offset:0}px,${a.horizontal?0:g*(a.pages-1)*-a.offset}px,0)`)}),h.render(y.createElement("div",N({ref:f,style:{...t,position:"absolute",top:0,left:0,willChange:"transform"}},n),y.createElement(Oe.Provider,{value:a},y.createElement(ce.Provider,{value:s},e)))),null}),qn=y.forwardRef(({html:e,...t},n)=>{const r=e?bn:wn;return y.createElement(r,N({ref:n},t))});function _n(e,t,n,r){const a=class extends Lt{constructor(m={}){const g=Object.entries(e);super({uniforms:g.reduce((s,[h,o])=>{const i=At.clone({[h]:{value:o}});return{...s,...i}},{}),vertexShader:t,fragmentShader:n}),this.key="",g.forEach(([s])=>Object.defineProperty(this,s,{get:()=>this.uniforms[s].value,set:h=>this.uniforms[s].value=h})),Object.assign(this,m),r&&r(this)}};return a.key=jt.generateUUID(),a}const qe=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function ke(e,t){const n=z(f=>f.gl),r=W(Me,qe(e)?Object.values(e):e);return y.useLayoutEffect(()=>{t==null||t(r)},[t]),y.useEffect(()=>{"initTexture"in n&&(Array.isArray(r)?r:[r]).forEach(n.initTexture)},[n,r]),y.useMemo(()=>{if(qe(e)){const f={};let m=0;for(const g in e)f[g]=r[m++];return f}else return r},[e,r])}ke.preload=e=>W.preload(Me,e);ke.clear=e=>W.clear(Me,e);const En=()=>parseInt(It.replace(/\D+/g,"")),Cn=En(),Ge=_n({color:new We("white"),scale:new Ce(1,1),imageBounds:new Ce(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},`
  varying vec2 vUv;
  varying vec2 vPos;
  void main() {
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
    vUv = uv;
    vPos = position.xy;
  }
`,`
  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44
  varying vec2 vUv;
  varying vec2 vPos;
  uniform vec2 scale;
  uniform vec2 imageBounds;
  uniform float resolution;
  uniform vec3 color;
  uniform sampler2D map;
  uniform float radius;
  uniform float zoom;
  uniform float grayscale;
  uniform float opacity;
  const vec3 luma = vec3(.299, 0.587, 0.114);
  vec4 toGrayscale(vec4 color, float intensity) {
    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);
  }
  vec2 aspect(vec2 size) {
    return size / min(size.x, size.y);
  }
  
  const float PI = 3.14159265;
    
  // from https://iquilezles.org/articles/distfunctions
  float udRoundBox( vec2 p, vec2 b, float r ) {
    return length(max(abs(p)-b+r,0.0))-r;
  }

  void main() {
    vec2 s = aspect(scale);
    vec2 i = aspect(imageBounds);
    float rs = s.x / s.y;
    float ri = i.x / i.y;
    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);
    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;
    vec2 uv = vUv * s / new + offset;
    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);

    vec2 res = vec2(scale * resolution);
    vec2 halfRes = 0.5 * res;
    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    
	  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));
    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);
    
    #include <tonemapping_fragment>
    #include <${Cn>=154?"colorspace_fragment":"encodings_fragment"}>
  }
`),dt=y.forwardRef(({children:e,color:t,segments:n=1,scale:r=1,zoom:a=1,grayscale:f=0,opacity:m=1,radius:g=0,texture:s,toneMapped:h,transparent:o,side:i,...c},p)=>{Ye({ImageMaterial:Ge});const d=y.useRef(null),C=z(w=>w.size),v=Array.isArray(r)?[r[0],r[1]]:[r,r],l=[s.image.width,s.image.height],u=Math.max(C.width,C.height);return y.useImperativeHandle(p,()=>d.current,[]),y.useLayoutEffect(()=>{d.current.geometry.parameters&&d.current.material.scale.set(v[0]*d.current.geometry.parameters.width,v[1]*d.current.geometry.parameters.height)},[]),y.createElement("mesh",N({ref:d,scale:Array.isArray(r)?[...r,1]:r},c),y.createElement("planeGeometry",{args:[1,1,n,n]}),y.createElement("imageMaterial",{color:t,map:s,zoom:a,grayscale:f,opacity:m,scale:v,imageBounds:l,resolution:u,radius:g,toneMapped:h,transparent:o,side:i,key:Ge.key}),e)}),Pn=y.forwardRef(({url:e,...t},n)=>{const r=ke(e);return y.createElement(dt,N({},t,{texture:r,ref:n}))}),Sn=y.forwardRef(({url:e,...t},n)=>y.createElement(dt,N({},t,{ref:n}))),Wn=y.forwardRef((e,t)=>{if(e.url)return y.createElement(Pn,N({},e,{ref:t}));if(e.texture)return y.createElement(Sn,N({},e,{ref:t}));throw new Error("<Image /> requires a url or texture")});let ae=null,pt="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function vt(e,t,n){return r=>{n&&n(r),e&&(ae||(ae=new Ut),ae.setDecoderPath(typeof e=="string"?e:pt),r.setDRACOLoader(ae)),t&&r.setMeshoptDecoder(typeof ve=="function"?ve():ve)}}function Te(e,t=!0,n=!0,r){return W(Re,e,vt(t,n,r))}Te.preload=(e,t=!0,n=!0,r)=>W.preload(Re,e,vt(t,n,r));Te.clear=e=>W.clear(Re,e);Te.setDecoderPath=e=>{pt=e};const Vn=y.forwardRef(({makeDefault:e,camera:t,regress:n,domElement:r,enableDamping:a=!0,keyEvents:f=!1,onChange:m,onStart:g,onEnd:s,...h},o)=>{const i=z(P=>P.invalidate),c=z(P=>P.camera),p=z(P=>P.gl),d=z(P=>P.events),C=z(P=>P.setEvents),v=z(P=>P.set),l=z(P=>P.get),u=z(P=>P.performance),w=t||c,M=r||d.connected||p.domElement,E=y.useMemo(()=>new Nt(w),[w]);return fe(()=>{E.enabled&&E.update()},-1),y.useEffect(()=>(f&&E.connect(f===!0?M:f),E.connect(M),()=>void E.dispose()),[f,M,n,E,i]),y.useEffect(()=>{const P=T=>{i(),n&&u.regress(),m&&m(T)},L=T=>{g&&g(T)},O=T=>{s&&s(T)};return E.addEventListener("change",P),E.addEventListener("start",L),E.addEventListener("end",O),()=>{E.removeEventListener("start",L),E.removeEventListener("end",O),E.removeEventListener("change",P)}},[m,g,s,E,i,C]),y.useEffect(()=>{if(e){const P=l().controls;return v({controls:E}),()=>v({controls:P})}},[e,E]),y.createElement("primitive",N({ref:o,object:E,enableDamping:a},h))});function Xn(e){const t=y.useRef(null),n=y.useRef(!1),r=y.useRef(!1),a=y.useRef(e);return y.useLayoutEffect(()=>void(a.current=e),[e]),y.useEffect(()=>{const f=t.current;if(f){const m=un(()=>(n.current=!1,!0)),g=f.onBeforeRender;f.onBeforeRender=()=>n.current=!0;const s=fn(()=>(n.current!==r.current&&(a.current==null||a.current(r.current=n.current)),!0));return()=>{f.onBeforeRender=g,m(),s()}}},[]),t}function Mn(e,t,n=new X){const r=Math.PI*(e-.5),a=2*Math.PI*(t-.5);return n.x=Math.cos(a),n.y=Math.sin(r),n.z=Math.sin(a),n}const Yn=y.forwardRef(({inclination:e=.6,azimuth:t=.1,distance:n=1e3,mieCoefficient:r=.005,mieDirectionalG:a=.8,rayleigh:f=.5,turbidity:m=10,sunPosition:g=Mn(e,t),...s},h)=>{const o=y.useMemo(()=>new X().setScalar(n),[n]),[i]=y.useState(()=>new $t);return y.createElement("primitive",N({object:i,ref:h,"material-uniforms-mieCoefficient-value":r,"material-uniforms-mieDirectionalG-value":a,"material-uniforms-rayleigh-value":f,"material-uniforms-sunPosition-value":g,"material-uniforms-turbidity-value":m,scale:o},s))});export{Nn as C,Wn as I,Vn as O,Yn as S,Fn as _,Un as a,$n as b,zn as c,qn as d,z as e,Xn as f,Hn as g,fe as h,Te as u};
//# sourceMappingURL=@react-three-BFRjeCcN.js.map
